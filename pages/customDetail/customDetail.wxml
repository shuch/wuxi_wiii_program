<view class="container">
  <view class="section">
  	<image class="section-img" src="{{cdn}}/custom_detail_img.png" mode="scaleToFill" />
    <view bind:tap="onLikeStar" data-id="{{customId}}" class="custom-like-top">
    	<image class="icon-like" src="{{cdn}}/like.png" mode="scaleToFill" wx:if="{{customDetail.isThumbsUp}}" />
      <image class="icon-like" src="{{cdn}}/un_like.png" mode="scaleToFill" wx:else />
      {{customDetail.likes.length}}
    </view>
    <view class="button-3d" bind:tap="onRoute3D" wx:if="customDetail.image3d">查看3D效果</view>
  </view>
  <view class="section section-custom">
  	<view class="like-box" wx:if="{{customDetail.inviteList.length}}">
  		<view class="like-list">
        <block wx:for="{{customDetail.inviteList}}" wx:key="item" wx:if="{{index<5}}">
          <image class="like-avatar" src="{{item.headImage}}" mode="scaleToFill" wx:if="{{item.headImage}}"/>
          <image class="like-avatar" src="{{cdn}}/avatar.png" mode="scaleToFill" wx:else/>
        </block>
  		</view>
		  成功邀请<text class="theme-color">{{customDetail.inviteList.length}}人</text>
    </view>
    <view class="h1">{{customDetail.name}}</view>
  	<view class="row-tabs">
  		<view
  			class="tabs {{tabSelected === 0 ? 'tabs-active' : ''}}"
  			data-id="0"
  			bind:tap="switchTab"
  		>方案详情</view>
      <view
        class="tabs {{tabSelected === 1 ? 'tabs-active' : ''}}"
        data-id="1"
        bind:tap="switchTab"
      >户型图</view>
  		<view
  			class="tabs {{tabSelected === (idx + 2) ? 'tabs-active' : ''}}"
  			wx:for="{{customDetail.spaces}}"
        wx:key="{{idx}}"
  			wx:for-index="idx"
  			data-id="{{idx + 2}}"
  			bind:tap="switchTab"
  		>
  			{{item.name}}
  		</view>
  	</view>
  	<view class="pane" wx:if="{{tabSelected === 0 }}">
  		<image class="center-img custom-img" src="{{customImageUrl}}" style="width:{{imgWidth}}px;height:{{imgHeight}}px;top:{{imgTop}}px;left:{{imgLeft}}px" mode="aspectFit" />
  		<view
  		  class="space-indicator space-center-top"
  		>
  		  <image class="space-plus" src="{{cdn}}/position.png" mode="scaleToFill" />
  		  <text class="space-name">{{customDetail.spaces[0].name}}</text>
  		</view>
  		<view
  		  class="space-indicator space-center-bottom"
  		>
  		  <image class="space-plus" src="{{cdn}}/position.png" mode="scaleToFill" />
  		  <text class="space-name">{{customDetail.spaces[1].name}}</text>
  		</view>
  		<view class="comment-area {{commentExpand ? '' : 'comment-unfold'}}" wx:if="{{customDetail.comments.length}}">
  		  <view
  		    class="comment-title"
  		    wx:if="{{customDetail.comments.length > 2}}"
  		    bind:tap="toggleExpand"
			style="background:{{commentExpand?'#D5D5D5 url(https://dm.static.elab-plus.com/wuXiW3/index/close.png)no-repeat  120rpx center/28rpx 15rpx':'#D5D5D5 url(https://dm.static.elab-plus.com/wuXiW3/index/open.png)no-repeat 120rpx center/28rpx 15rpx'}}"
		  >
  		    {{commentExpand ? '收起' : '展开'}}评论
  		  </view>
			<view style="height: calc( 100% - 60rpx );overflow-y: auto">
				<view class="comment-list">
					<view
							class="comment-item"
							wx:for="{{customDetail.comments}}"
							wx:for-index="idx"
							wx:key="item"
							data-id="{{item.id}}"
							data-index="{{idx}}"
							bind:tap="delComment"
					>
						{{item.commentText}}
						<image wx:if="{{commentMode}}" class="icon-close" src="{{cdn}}/close.png" mode="scaleToFill"></image>
					</view>
				</view>
			</view>

  		</view>
  	</view>
    <view class="pane" wx:elif="{{tabSelected === 1 }}">
      <image class="center-img custom-img" src="{{customDetail.imageUrl}}" mode="aspectFit" />
    </view>
  	<view class="pane" wx:else>
  		<image class="center-img space-img" src="{{customDetail.spaces[tabSelected - 2].imageUrl}}" mode="aspectFit" />
  		<view
  		  class="space-indicator space-center"
  		>
  		  <image class="space-plus" src="{{cdn}}/position.png" mode="scaleToFill" />
  		  <text class="space-name">{{customDetail.spaces[tabSelected - 2].name}}</text>
  		</view>
  	</view>
  </view>
  <view class="section section-rank">
  	<view class="section-title">
  		<text class="flex-1">明星户型排行榜</text>
  		<text class="section-more" bind:tap="onRouteStar">查看更多</text>
  		<image class="icon-right" src="{{cdn}}/more_grey.png" mode="scaleToFill"/>
  	</view>
  	<view class="rank-star">
  		<view class="rank-star-box" wx:for="{{rankList}}" wx:key="{{item.id}}">
  			<view class="rank-star-album">
  				<image class="rank-star-img" src="{{item.src}}" mode="aspectFill"/>
  				<view
            class="custom-like"
            data-id="{{item.id}}"
            bind:tap="onLikeStar"
          >
            <image wx:if="{{item.isLike}}" class="icon-like-rank" src="{{cdn}}/like.png" mode="scaleToFill" />
            <image wx:else class="icon-like-rank" src="{{cdn}}/un_like.png" mode="scaleToFill" />
            {{item.like}}
  				</view>
  			</view>
  			<image style="position: absolute;left: 0;bottom: 0;width:100%;height: 120rpx" src="https://dm.static.elab-plus.com/wuXiW3/index/icover.png"></image>
        <view class="rank-star-info">
          <image class="rank-star-avatar" src="{{item.owner.avatar}}" mode="scaleToFill"/>
          {{item.owner.name}}
        </view>
		</view>
  	</view>
  </view>
  <view class="section section-banner">
  	<image class="banner" src="https://dm.static.elab-plus.com/wuXiW3/index/banner图1@2x.png" mode="scaleToFill"/>
  </view>
  <view class="bottom">
  	<view class="center service" bind:tap="onRouteService">
  		<image class="icon-service" src="{{cdn}}/service.png" mode="scaleToFill" />
  	</view>
  	<view class="flex-1 center btn-grey" bind:tap="onEdit" wx:if="{{isSelf}}">
      编辑修改
    </view>
    <view class="flex-1 center btn-grey" bind:tap="onSave" wx:else>
      存入方案
    </view>
  	<view class="flex-1 center btn-glod" bind:tap="menuShare" wx:if="{{isSelf}}">分享方案</view>
    <view class="flex-1 center btn-glod" bind:tap="onRouteCustom" wx:else>DIY我的house</view>
  </view>
</view>

<component-action-sheet
	wx:if="{{doShare}}"
	bind:onclose="onClose"
	timeline-src="{{timelineSrc}}"
	bind:onsaveimage="onSaveImage"
/>
